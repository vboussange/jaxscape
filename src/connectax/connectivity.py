
def functional_habitat(q, K):
    return q @ (K @ q)
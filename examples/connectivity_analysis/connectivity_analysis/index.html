
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A minimal JAX library for connectivity modelling at scale">
      
      
        <meta name="author" content="Victor Boussange">
      
      
        <link rel="canonical" href="https://vboussange.github.io/jaxscape/examples/connectivity_analysis/connectivity_analysis/">
      
      
        <link rel="prev" href="../../distance_calculation/distance_calculation/">
      
      
        <link rel="next" href="../../inverse_landscape_genetics/inverse_landscape_genetics/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Connectivity analysis - JAXScape</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../_static/custom_css.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#connectivity-and-sensitivity-analysis-at-scale" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="JAXScape" class="md-header__button md-logo" aria-label="JAXScape" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            JAXScape
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Connectivity analysis
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/vboussange/jaxscape" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    vboussange/jaxscape
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="JAXScape" class="md-nav__button md-logo" aria-label="JAXScape" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    JAXScape
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/vboussange/jaxscape" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    vboussange/jaxscape
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distance_calculation/distance_calculation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distance calculation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Connectivity analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Connectivity analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-dispersal-parameters-for-the-target-species" class="md-nav__link">
    <span class="md-ellipsis">
      
        Define dispersal parameters for the target species
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculate-landscape-connectivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Calculate landscape connectivity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensitivity-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sensitivity analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conservation-prioritization-comparing-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conservation prioritization: comparing strategies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Takeaways
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../inverse_landscape_genetics/inverse_landscape_genetics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inverse landscape genetics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/moving_windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced topics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/graphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graphs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/distances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distance metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linear solvers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/connectivity_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connectivity analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/window_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Window operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="connectivity-and-sensitivity-analysis-at-scale">Connectivity and sensitivity analysis at scale<a class="headerlink" href="#connectivity-and-sensitivity-analysis-at-scale" title="Permanent link">¤</a></h1>
<p>This notebook demonstrates how to quantify ecological connectivity and perform sensitivity analysis over large landscapes, leveraging moving windows to accelerate computations using the <code>ConnectivityAnalysis</code> and <code>SensitivityAnalysis</code> utilities.</p>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>jaxscape<span class="w"> </span>rasterio<span class="w"> </span>matplotlib
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.random</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rasterio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jaxscape</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConnectivityAnalysis</span><span class="p">,</span> <span class="n">LCPDistance</span><span class="p">,</span> <span class="n">SensitivityAnalysis</span>
</code></pre></div>
<h2 id="load-data">Load data<a class="headerlink" href="#load-data" title="Permanent link">¤</a></h2>
<p>We load a habitat "suitability" raster (typically the output of a species distribution model), and confound it with the permeability raster. We also use it to weight the importance of each site when calculating connectivity (see thereafter). In practice, you may want to use different rasters for these purposes.</p>
<p>The raster values are normalized to [0, 1] range, with 0 representing unsuitable habitat and 1 representing optimal conditions.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Load habitat suitability raster</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;../data/suitability.tif&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">raster</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Read first band with masking</span>
    <span class="n">quality_raster</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">raster</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="p">)</span>  <span class="c1"># Normalize to [0, 1]</span>

<span class="c1"># Visualize the landscape</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">quality_raster</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Habitat Quality/Permeability&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Input Landscape&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="img" src="../_data/d728ec032b4f4a878e2e931c6fc8658d.png" /></p>
<h2 id="define-dispersal-parameters-for-the-target-species">Define dispersal parameters for the target species<a class="headerlink" href="#define-dispersal-parameters-for-the-target-species" title="Permanent link">¤</a></h2>
<p>We need to specify:</p>
<ul>
<li><strong>Dispersal range (D)</strong>: maximum distance an individual can traverse (in pixels) through optimal habitat (permeability = 1)</li>
<li><strong>Distance metric</strong></li>
<li><strong>Proximity function</strong>: how distance translates to a certain probability of dispersal</li>
</ul>
<p>Common proximity functions are
- <strong>Negative exponential</strong>: <code>exp(-d/D)</code> for smooth decay (used here)
- <strong>Threshold</strong>: <code>(d &lt; D).astype(float)</code> for binary connectivity
- <strong>Power law</strong>: <code>d**(-α)</code> for fat-tailed dispersal</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define dispersal range (in pixels; you&#39;d need to convert from real units based on raster resolution)</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Maximum dispersal distance through optimal habitat</span>

<span class="n">distance</span> <span class="o">=</span> <span class="n">LCPDistance</span><span class="p">()</span>


<span class="c1"># Define proximity function: converts distance to probability of dispersal</span>
<span class="k">def</span><span class="w"> </span><span class="nf">proximity</span><span class="p">(</span><span class="n">dist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Negative exponential decay of connectivity with distance.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dist</span> <span class="o">/</span> <span class="n">D</span><span class="p">)</span>
</code></pre></div>
<h2 id="calculate-landscape-connectivity">Calculate landscape connectivity<a class="headerlink" href="#calculate-landscape-connectivity" title="Permanent link">¤</a></h2>
<p><code>ConnectivityAnalysis</code> computes the overall landscape connectivity by summing quality-weighted proximities between all pairs of habitat cells. This produces a scalar measure of total connectivity.</p>
<p><strong>Key parameters:</strong>
- <code>quality_raster</code>: Habitat quality or patch importance
- <code>permeability_raster</code>: Movement cost surface
- <code>distance</code>: Distance metric (LCP, Resistance, or RSP)
- <code>proximity</code>: Function converting distance to connectivity
- <code>dependency_range</code>: Maximum relevant distance (optimization parameter)
- <code>batch_size</code>: Parallel processing batch size (tune based on available memory)
- <code>q_weighted</code>: Whether to weight by quality (<code>True</code>) or not (<code>False</code>)</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Initialize connectivity analysis</span>
<span class="n">connectivity_prob</span> <span class="o">=</span> <span class="n">ConnectivityAnalysis</span><span class="p">(</span>
    <span class="n">quality_raster</span><span class="o">=</span><span class="n">quality_raster</span><span class="p">,</span>
    <span class="n">permeability_raster</span><span class="o">=</span><span class="n">quality_raster</span><span class="p">,</span>
    <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
    <span class="n">proximity</span><span class="o">=</span><span class="n">proximity</span><span class="p">,</span>
    <span class="n">dependency_range</span><span class="o">=</span><span class="n">D</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Process 50 cells per batch</span>
<span class="p">)</span>

<span class="c1"># Compute baseline connectivity (unweighted by quality)</span>
<span class="n">connectivity</span> <span class="o">=</span> <span class="n">connectivity_prob</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">q_weighted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Baseline landscape connectivity: </span><span class="si">{</span><span class="n">connectivity</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Batch progress:   0%|          | 0/6 [00:00&lt;?, ?it/s]
</code></pre></div>
<div class="highlight"><pre><span></span><code>Batch progress: 100%|██████████| 6/6 [00:09&lt;00:00,  1.60s/it]
</code></pre></div>
<div class="highlight"><pre><span></span><code>Baseline landscape connectivity: 3843798
</code></pre></div>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Coarsening factor</p>
<p>You can specify a <code>coarsening_factor</code> to aggregate the raster spatially, reducing resolution to speed up computations. A value of 0.0 means no aggregation, while higher values increase aggregation. This is an experimental feature and may affect accuracy.</p>
</div>
<h2 id="sensitivity-analysis">Sensitivity analysis<a class="headerlink" href="#sensitivity-analysis" title="Permanent link">¤</a></h2>
<p><code>SensitivityAnalysis</code> computes the derivative of <code>ConnectivityAnalysis</code> with respect to either permeability or quality. This allows identifying which landscape cells, when improved, would most increase overall connectivity.</p>
<p>The output is a raster where each cell value represents the marginal effect of improving that cell on total connectivity.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Initialize sensitivity analysis</span>
<span class="n">sensitivity_prob</span> <span class="o">=</span> <span class="n">SensitivityAnalysis</span><span class="p">(</span>
    <span class="n">quality_raster</span><span class="o">=</span><span class="n">quality_raster</span><span class="p">,</span>
    <span class="n">permeability_raster</span><span class="o">=</span><span class="n">quality_raster</span><span class="p">,</span>
    <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
    <span class="n">proximity</span><span class="o">=</span><span class="n">proximity</span><span class="p">,</span>
    <span class="n">dependency_range</span><span class="o">=</span><span class="n">D</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># Smaller batch size for memory efficiency</span>
<span class="p">)</span>

<span class="c1"># Compute sensitivity with respect to permeability</span>
<span class="n">sensitivity_permeability</span> <span class="o">=</span> <span class="n">sensitivity_prob</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;permeability&quot;</span><span class="p">,</span> <span class="n">q_weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Batch progress: 100%|██████████| 32/32 [00:29&lt;00:00,  1.08it/s]
</code></pre></div>
<p>It is usually advised to convert sensitivity to <strong>elasticity</strong>, which express the proportional change in connectivity from a proportional change in permeability. This is computed as:</p>
<div class="arithmatex">\[\text{Elasticity} = \frac{\partial C}{\partial p} \times p\]</div>
<p>where <span class="arithmatex">\(C\)</span> is the ecological connectivity and <span class="arithmatex">\(p\)</span> is permeability.</p>
<p>Elasticity is more interpretable than raw sensitivity because it's scale-independent and represents percent change in connectivity per percent change in permeability.</p>
<p><strong>High elasticity areas</strong> are the most impactful for conservation - small improvements there yield large connectivity gains.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Compute elasticity: sensitivity × current permeability</span>
<span class="n">elasticity</span> <span class="o">=</span> <span class="n">sensitivity_permeability</span> <span class="o">*</span> <span class="n">quality_raster</span>
<span class="n">elasticity</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">elasticity</span><span class="p">,</span> <span class="n">nan</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># Replace NaN with 0</span>

<span class="c1"># Visualize elasticity on log scale (highlights variation)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">elasticity</span> <span class="o">+</span> <span class="mf">1e-2</span><span class="p">,</span>  <span class="c1"># Add small constant for log scale</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;plasma&quot;</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e0</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Elasticity w.r.t permeability&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="img" src="../_data/44d1872a680f4b3eadd4cef318ef3ba4.png" /></p>
<h2 id="conservation-prioritization-comparing-strategies">Conservation prioritization: comparing strategies<a class="headerlink" href="#conservation-prioritization-comparing-strategies" title="Permanent link">¤</a></h2>
<p>We now compare two prioritization strategies for habitat restoration, to demonstrate the practical value of sensitivity analysis:</p>
<ol>
<li><strong>Elasticity-based</strong>: Target the top 5% of cells by elasticity</li>
<li><strong>Random</strong>: Target random cells (control)</li>
</ol>
<p>For each strategy, we simulate improving permeability by 0.4 units (40% of the scale) and measure the resulting gain in landscape connectivity.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define improvement magnitude</span>
<span class="n">improved_permeability</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># Permeability increase per restored cell</span>

<span class="c1"># Strategy 1: Target high elasticity cells (top 5%)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">elasticity</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span>  <span class="c1"># 95th percentile</span>
<span class="n">high_sensitivity_coords</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">elasticity</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span>
<span class="n">improved_quality_raster</span> <span class="o">=</span> <span class="n">quality_raster</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">high_sensitivity_coords</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">improved_permeability</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Strategy 1: Restoring </span><span class="si">{</span><span class="n">high_sensitivity_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> cells based on elasticity&quot;</span>
<span class="p">)</span>

<span class="c1"># Strategy 2: Target random cells (same number as Strategy 1)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">random_indices</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
    <span class="n">key</span><span class="p">,</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">elasticity</span><span class="o">.</span><span class="n">size</span><span class="p">),</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">high_sensitivity_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">,),</span>
    <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">random_coords</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">random_indices</span><span class="p">,</span> <span class="n">quality_raster</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">modified_quality_raster</span> <span class="o">=</span> <span class="n">quality_raster</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">random_coords</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">improved_permeability</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy 2: Restoring </span><span class="si">{</span><span class="n">random_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> random cells (control)&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Strategy 1: Restoring 974 cells based on elasticity
Strategy 2: Restoring 974 random cells (control)
</code></pre></div>
<p>We now compute landscape connectivity for:
1. Baseline (no restoration)
2. Elasticity-based restoration
3. Random restoration</p>
<p>The connectivity gain is expressed as a percentage increase over baseline.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_connectivity_analysis</span><span class="p">(</span><span class="n">raster</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to compute connectivity for a given permeability raster.&quot;&quot;&quot;</span>
    <span class="n">connectivity_prob</span> <span class="o">=</span> <span class="n">ConnectivityAnalysis</span><span class="p">(</span>
        <span class="n">quality_raster</span><span class="o">=</span><span class="n">quality_raster</span><span class="p">,</span>
        <span class="n">permeability_raster</span><span class="o">=</span><span class="n">raster</span><span class="p">,</span>
        <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
        <span class="n">proximity</span><span class="o">=</span><span class="n">proximity</span><span class="p">,</span>
        <span class="n">coarsening_factor</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">dependency_range</span><span class="o">=</span><span class="n">D</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">connectivity_prob</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">q_weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># Compute connectivity for all scenarios</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing connectivity for baseline...&quot;</span><span class="p">)</span>
<span class="n">base_connectivity</span> <span class="o">=</span> <span class="n">run_connectivity_analysis</span><span class="p">(</span><span class="n">quality_raster</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing connectivity for elasticity-based restoration...&quot;</span><span class="p">)</span>
<span class="n">connectivity_improved</span> <span class="o">=</span> <span class="n">run_connectivity_analysis</span><span class="p">(</span><span class="n">improved_quality_raster</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing connectivity for random restoration...&quot;</span><span class="p">)</span>
<span class="n">connectivity_improved_randomly</span> <span class="o">=</span> <span class="n">run_connectivity_analysis</span><span class="p">(</span><span class="n">modified_quality_raster</span><span class="p">)</span>

<span class="c1"># Calculate percent gains</span>
<span class="n">elasticity_gain</span> <span class="o">=</span> <span class="p">(</span><span class="n">connectivity_improved</span> <span class="o">-</span> <span class="n">base_connectivity</span><span class="p">)</span> <span class="o">/</span> <span class="n">base_connectivity</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">random_gain</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">connectivity_improved_randomly</span> <span class="o">-</span> <span class="n">base_connectivity</span><span class="p">)</span> <span class="o">/</span> <span class="n">base_connectivity</span> <span class="o">*</span> <span class="mi">100</span>
<span class="p">)</span>

<span class="c1"># Visualize comparison</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">strategies</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Baseline&quot;</span><span class="p">,</span> <span class="s2">&quot;Elasticity-based&quot;</span><span class="p">,</span> <span class="s2">&quot;Random&quot;</span><span class="p">]</span>
<span class="n">connectivities</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">base_connectivity</span><span class="p">,</span>
    <span class="n">connectivity_improved</span><span class="p">,</span>
    <span class="n">connectivity_improved_randomly</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">]</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">strategies</span><span class="p">,</span> <span class="n">connectivities</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Landscape Connectivity&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Restoration Strategy Comparison&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add percentage labels</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">connectivities</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">gain</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">base_connectivity</span><span class="p">)</span> <span class="o">/</span> <span class="n">base_connectivity</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">(),</span>
            <span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">gain</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Computing connectivity for baseline...
</code></pre></div>
<div class="highlight"><pre><span></span><code>Batch progress: 100%|██████████| 6/6 [00:09&lt;00:00,  1.60s/it]
</code></pre></div>
<div class="highlight"><pre><span></span><code>Computing connectivity for elasticity-based restoration...
</code></pre></div>
<div class="highlight"><pre><span></span><code>Batch progress: 100%|██████████| 6/6 [00:09&lt;00:00,  1.60s/it]
</code></pre></div>
<div class="highlight"><pre><span></span><code>Computing connectivity for random restoration...
</code></pre></div>
<div class="highlight"><pre><span></span><code>Batch progress: 100%|██████████| 6/6 [00:09&lt;00:00,  1.60s/it]
</code></pre></div>
<p><img alt="img" src="../_data/183e45adff6149a7891bf9ffdf5a327c.png" /></p>
<p>The results demonstrate the advantage of using elasticity-based prioritization over random selection. By targeting high-elasticity areas, we achieve greater connectivity gains with the same restoration budget.</p>
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link">¤</a></h2>
<p>This notebook demonstrated how <strong>sensitivity analysis</strong> identifies landscape modifications with the greatest connectivity impact. By converting raw sensitivity to <strong>elasticity</strong> (a scale-independent measure), we can prioritize restoration sites objectively. The results show that elasticity-based targeting substantially outperforms random selection, achieving greater connectivity gains with the same restoration budget.</p>
<p>JAXScape's automatic differentiation through JAX enables efficient computation of these gradient-based metrics at landscape scale. The framework is highly flexible: you can substitute different distance metrics (LCP, Resistance, RSP), proximity functions (exponential, threshold, power law), dispersal parameters, or conservation objectives (quality enhancement versus permeability improvement) to match your species and management scenarios. You may also implement your own definition of ecological connectivity; see the <a href="https://vboussange.github.io/jaxscape/api/connectivity_analysis/">API reference</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.sections", "toc.integrate", "header.autohide", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../_static/javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>